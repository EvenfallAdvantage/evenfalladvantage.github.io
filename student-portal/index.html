<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Portal | Evenfall Advantage</title>
    <style>
        html, body { margin: 0 !important; padding: 0 !important; }
    </style>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="css/student-portal.css">
    <link rel="stylesheet" href="css/profile.css">
    <link rel="stylesheet" href="css/site-assessments.css">
    <link rel="stylesheet" href="../css/messaging.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Raleway:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Supabase JavaScript Client -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- PDF Generation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body style="margin:0;padding:0;">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-container">
                <div class="nav-brand">
                    <a href="../index.html" class="logo-link">
                        <img src="../images/logo.png" alt="Evenfall Advantage Logo" class="nav-logo">
                    </a>
                </div>
                <div class="portal-content">
                    <h2 class="portal-title">Student Portal</h2>
                    <div class="portal-nav-container">
                        <div class="nav-links">
                            <a href="#home" class="nav-link active" data-section="home">Home</a>
                            <a href="#training" class="nav-link" data-section="training">Learn</a>
                            <a href="#sandtable" class="nav-link" data-section="sandtable">Practice</a>
                            <a href="#assessment" class="nav-link" data-section="assessment">Assess</a>
                            <a href="#messages" class="nav-link" data-section="messages">Messages</a>
                            <a href="#profile" class="nav-link" data-section="profile">Profile</a>
                            <a href="javascript:void(0)" class="nav-link" onclick="logout()">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Section -->
        <section id="home" class="section active">
            <div class="hero">
                <div class="hero-quote">
                    <blockquote>
                        <p>The more you sweat in training, the less you bleed in battle.</p>
                        <cite>â€” Sun Tzu</cite>
                    </blockquote>
                </div>
                <p class="hero-subtitle">Interactive Scenario Planning & Knowledge Assessments</p>
                <div class="hero-cards">
                    <div class="hero-card" onclick="navigateToSection('training')" style="cursor: pointer;">
                        <i class="fas fa-book-open"></i>
                        <h3>Learn</h3>
                        <p>Essential event security procedures and protocols</p>
                    </div>
                    <div class="hero-card" onclick="navigateToSection('sandtable')" style="cursor: pointer;">
                        <i class="fas fa-hands-helping"></i>
                        <h3>Practice</h3>
                        <p>Interactive event layout and security planning</p>
                    </div>
                    <div class="hero-card" onclick="navigateToSection('assessment')" style="cursor: pointer;">
                        <i class="fas fa-trophy"></i>
                        <h3>Assess</h3>
                        <p>Validate your security guard knowledge</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Training Section -->
        <section id="training" class="section">
            <div class="section-header">
                <h2>My Courses</h2>
                <p>Select a course to view its modules and continue learning</p>
            </div>
            
            <!-- My Enrolled Courses -->
            <div id="myCoursesContainer" class="courses-container">
                <div style="text-align: center; padding: 2rem;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--secondary);"></i>
                    <p>Loading your courses...</p>
                </div>
            </div>

            <!-- Course Modules View (shown when a course is selected) -->
            <div id="courseModulesView" class="course-modules-view" style="display: none;">
                <div class="section-header">
                    <button class="btn btn-secondary" onclick="backToCourses()">
                        <i class="fas fa-arrow-left"></i> Back to Courses
                    </button>
                    <h2 id="selectedCourseName">Course Modules</h2>
                    <p id="selectedCourseDescription"></p>
                </div>
                <div class="training-modules" id="trainingModulesContainer">
                    <!-- Modules will be loaded dynamically when course is selected -->
                </div>
            </div>

            <!-- Available Courses (not enrolled) -->
            <div id="availableCoursesSection" class="section-divider">
                <div class="section-header">
                    <h2>Available Courses</h2>
                    <p>Enroll in additional courses to expand your training</p>
                </div>
                <div id="availableCoursesContainer" class="courses-container">
                    <div style="text-align: center; padding: 2rem;">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--secondary);"></i>
                        <p>Loading available courses...</p>
                    </div>
                </div>
            </div>

            <!-- Module Content Modal -->
            <div id="moduleModal" class="modal">
                <div class="modal-content slideshow-modal">
                    <div class="modal-header">
                        <div class="slideshow-header-content">
                            <h2 id="moduleTitle"></h2>
                            <div class="slide-progress">
                                <span id="slideCounter">Slide 1 of 10</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar-fill" id="slideProgressBar"></div>
                                </div>
                            </div>
                        </div>
                        <button class="close-btn" onclick="closeModule()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body slideshow-body" id="moduleContent">
                        <!-- Dynamic slideshow content loaded here -->
                    </div>
                    <div class="modal-footer slideshow-footer">
                        <button class="btn btn-secondary" onclick="previousSlide()" id="prevSlideBtn">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <div class="slide-dots" id="slideDots"></div>
                        <button class="btn btn-primary" onclick="nextSlide()" id="nextSlideBtn">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="btn btn-primary hidden" onclick="completeModule()" id="completeModuleBtn">
                            Complete Module <i class="fas fa-check"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Practice Section -->
        <!-- Updated: 2026-02-02 23:13 -->
        <section id="sandtable" class="section">
            <!-- Practice Tabs -->
            <div class="profile-tabs">
                <button class="profile-tab active" data-tab="sandtable-practice">
                    <i class="fas fa-map-marked-alt"></i> Sand Table
                </button>
                <button class="profile-tab" data-tab="site-assessments-practice">
                    <i class="fas fa-clipboard-list"></i> Site Assessments
                </button>
                <button class="profile-tab" data-tab="deescalation-practice">
                    <i class="fas fa-hands-helping"></i> De-escalation
                </button>
            </div>

            <!-- Sand Table Tab -->
            <div class="profile-tab-content active" id="sandtable-practice-tab">
                <div class="sandtable-container">
                <!-- Scenario Selector -->
                <div class="scenario-selector">
                    <h3>Select Scenario</h3>
                    <select id="scenarioSelect">
                        <option value="">Choose a scenario...</option>
                        <option value="concert-venue">Outdoor Concert Security</option>
                        <option value="sports-event">Stadium Sports Event</option>
                        <option value="conference-center">Conference/Convention Security</option>
                        <option value="festival-grounds">Multi-Day Festival</option>
                    </select>
                </div>

                <div class="sandtable-workspace">
                    <!-- Toolbox -->
                    <div class="toolbox">
                        <h3>Security Resources</h3>
                        <div class="toolbox-category">
                            <h4>Personnel</h4>
                            <div class="tool-items" id="personnelTools">
                                <div class="tool-item" draggable="true" data-type="guard">
                                    <i class="fas fa-user-shield"></i>
                                    <span>Security Guard</span>
                                </div>
                                <div class="tool-item" draggable="true" data-type="supervisor">
                                    <i class="fas fa-user-tie"></i>
                                    <span>Supervisor</span>
                                </div>
                                <div class="tool-item" draggable="true" data-type="medic">
                                    <i class="fas fa-user-md"></i>
                                    <span>Medical Staff</span>
                                </div>
                                <div class="tool-item" draggable="true" data-type="usher">
                                    <i class="fas fa-user"></i>
                                    <span>Usher</span>
                                </div>
                            </div>
                        </div>
                        <div class="toolbox-category">
                            <h4>Barriers & Checkpoints</h4>
                            <div class="tool-items" id="barrierTools">
                                <div class="tool-item" draggable="true" data-type="barrier">
                                    <i class="fas fa-road"></i>
                                    <span>Barrier</span>
                                </div>
                                <div class="tool-item" draggable="true" data-type="checkpoint">
                                    <i class="fas fa-clipboard-check"></i>
                                    <span>Checkpoint</span>
                                </div>
                                <div class="tool-item" draggable="true" data-type="metal-detector">
                                    <i class="fas fa-magnet"></i>
                                    <span>Metal Detector</span>
                                </div>
                                <div class="tool-item" draggable="true" data-type="gate">
                                    <i class="fas fa-door-open"></i>
                                    <span>Entry Gate</span>
                                </div>
                            </div>
                        </div>
                        <div class="toolbox-category">
                            <h4>Equipment & Zones</h4>
                            <div class="tool-items" id="equipmentTools">
                                <div class="tool-item" draggable="true" data-type="camera">
                                    <i class="fas fa-video"></i>
                                    <span>Camera</span>
                                </div>
                                <div class="tool-item" draggable="true" data-type="command-post">
                                    <i class="fas fa-broadcast-tower"></i>
                                    <span>Command Post</span>
                                </div>
                                <div class="tool-item" draggable="true" data-type="emergency-exit">
                                    <i class="fas fa-sign-out-alt"></i>
                                    <span>Emergency Exit</span>
                                </div>
                                <div class="tool-item" draggable="true" data-type="first-aid">
                                    <i class="fas fa-first-aid"></i>
                                    <span>First Aid Station</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Canvas -->
                    <div class="canvas-area">
                        <div class="canvas-header">
                            <h3 id="scenarioTitle">Select a scenario to begin</h3>
                            <div class="canvas-controls">
                                <button class="btn btn-small" onclick="clearCanvas()">
                                    <i class="fas fa-trash"></i> Clear
                                </button>
                                <button class="btn btn-small btn-primary" onclick="validateSolution()">
                                    <i class="fas fa-check"></i> Validate
                                </button>
                            </div>
                        </div>
                        <div id="canvas" class="canvas">
                            <div class="canvas-placeholder">
                                <i class="fas fa-hand-pointer"></i>
                                <p>Drag security resources to the event layout to create your security plan</p>
                            </div>
                        </div>
                        <div class="scenario-description" id="scenarioDescription">
                            <!-- Scenario description will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Feedback Panel -->
                <div id="feedbackPanel" class="feedback-panel hidden">
                    <div class="feedback-content">
                        <div class="feedback-icon" id="feedbackIcon"></div>
                        <h3 id="feedbackTitle"></h3>
                        <p id="feedbackMessage"></p>
                        <div id="feedbackDetails"></div>
                        <button class="btn btn-primary" onclick="closeFeedback()">Continue</button>
                    </div>
                </div>
                </div>
            </div>

            <!-- Site Assessments Tab -->
            <div class="profile-tab-content" id="site-assessments-practice-tab">
                <div class="site-assessments-container">
                    <!-- Assessment Header -->
                    <div class="assessment-header">
                        <div class="header-content">
                            <h2><i class="fas fa-shield-alt"></i> Security Site Assessment Tool</h2>
                            <p>Professional security assessment and report generation</p>
                        </div>
                        <div class="header-controls">
                            <button class="btn btn-secondary" onclick="SiteAssessments.toggleTutorialMode()">
                                <i class="fas fa-graduation-cap"></i> <span id="tutorialToggleText">Tutorial Mode: OFF</span>
                            </button>
                            <button class="btn btn-secondary" onclick="SiteAssessments.loadTemplate()">
                                <i class="fas fa-folder-open"></i> Load Template
                            </button>
                            <button class="btn btn-secondary" onclick="SiteAssessments.saveTemplate()">
                                <i class="fas fa-save"></i> Save Template
                            </button>
                        </div>
                    </div>

                    <!-- Assessment Form -->
                    <div class="assessment-form" id="assessmentForm">
                        <!-- Form sections will be dynamically generated -->
                    </div>

                    <!-- Action Buttons -->
                    <div class="assessment-actions">
                        <button class="btn btn-secondary" onclick="SiteAssessments.resetForm()">
                            <i class="fas fa-redo"></i> Reset Form
                        </button>
                        <button class="btn btn-primary" onclick="SiteAssessments.generateReport()">
                            <i class="fas fa-file-alt"></i> Generate Report
                        </button>
                    </div>

                    <!-- Report Display -->
                    <div class="report-container" id="reportContainer" style="display: none;">
                        <div class="report-header">
                            <h2>Security Assessment Report</h2>
                            <div class="report-actions">
                                <button class="btn btn-secondary" onclick="SiteAssessments.printReport()">
                                    <i class="fas fa-print"></i> Print
                                </button>
                                <button class="btn btn-secondary" onclick="SiteAssessments.downloadPDF()">
                                    <i class="fas fa-download"></i> Download PDF
                                </button>
                                <button class="btn btn-secondary" onclick="SiteAssessments.closeReport()">
                                    <i class="fas fa-times"></i> Close
                                </button>
                            </div>
                        </div>
                        <div class="report-content" id="reportContent">
                            <!-- Report will be generated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- De-Escalation Training Tab -->
            <div class="profile-tab-content" id="deescalation-practice-tab">
                <div class="deescalation-container">
                    <!-- Scenario Selection Screen -->
                    <div id="deescalation-menu" class="deescalation-menu">
                        <h3>Select a Scenario</h3>
                        <div class="scenario-cards">
                            <div class="scenario-card" data-scenario="lost-wristband">
                                <i class="fas fa-ticket-alt"></i>
                                <h4>Lost Wristband at the Gate</h4>
                                <p>A patron claims they lost their entry wristband and wants to enter the venue.</p>
                                <div class="scenario-meta">
                                    <span><i class="fas fa-clock"></i> 10-15 min</span>
                                    <span><i class="fas fa-signal"></i> Intermediate</span>
                                </div>
                                <button class="btn btn-primary">Start Scenario</button>
                            </div>
                            
                            <div class="scenario-card" data-scenario="intoxicated-patron">
                                <i class="fas fa-wine-glass"></i>
                                <h4>Intoxicated Patron at Bar</h4>
                                <p>A female patron has been cut off from alcohol service and is becoming confrontational.</p>
                                <div class="scenario-meta">
                                    <span><i class="fas fa-clock"></i> 10-15 min</span>
                                    <span><i class="fas fa-signal"></i> Advanced</span>
                                </div>
                                <button class="btn btn-primary">Start Scenario</button>
                            </div>
                            
                            <div class="scenario-card" data-scenario="denied-entry-id">
                                <i class="fas fa-id-card"></i>
                                <h4>Denied Entry - Invalid ID</h4>
                                <p>A patron is being denied entry because his ID appears to be fake or expired.</p>
                                <div class="scenario-meta">
                                    <span><i class="fas fa-clock"></i> 10-15 min</span>
                                    <span><i class="fas fa-signal"></i> Intermediate</span>
                                </div>
                                <button class="btn btn-primary">Start Scenario</button>
                            </div>
                        </div>
                    </div>

                    <!-- Active Training Screen -->
                    <div id="deescalation-training" class="deescalation-training hidden">
                        <!-- Header with Back Button -->
                        <div class="training-header">
                            <h3 id="scenario-title">Lost Wristband at the Gate</h3>
                            <button class="btn btn-secondary" id="exit-scenario-btn">
                                <i class="fas fa-arrow-left"></i> Exit Scenario
                            </button>
                        </div>

                        <!-- Emotional Meter -->
                        <div class="emotional-meter">
                            <div class="meter-label">
                                <span>Emotional State</span>
                                <span id="meter-percentage">40%</span>
                            </div>
                            <div class="meter-bar">
                                <div class="meter-fill" id="meter-fill" style="width: 40%"></div>
                            </div>
                            <div class="meter-states">
                                <span class="state-calm">Calm</span>
                                <span class="state-elevated">Elevated</span>
                                <span class="state-critical">Critical</span>
                            </div>
                        </div>

                        <!-- Subject Photo and Dialogue -->
                        <div class="subject-interaction">
                            <div class="subject-photo">
                                <img id="subject-image" src="/images/de_escalation/1-Distressed.jpg" alt="Subject">
                                <div class="subject-state-label" id="subject-state">Distressed</div>
                            </div>
                            <div class="subject-dialogue">
                                <div class="dialogue-bubble" id="subject-dialogue">
                                    Look man, I swear I had my wristband... I think it fell off when I was in the bathroom line. My friends are already inside. I paid $180 for this ticket. You gotta let me in, please.
                                </div>
                            </div>
                        </div>

                        <!-- Response Choices -->
                        <div class="response-choices" id="response-choices">
                            <!-- Choices will be populated by JavaScript -->
                        </div>

                        <!-- Progress Indicator -->
                        <div class="progress-indicator">
                            <span>Step <span id="current-step">1</span> of <span id="total-steps">4-5</span></span>
                        </div>
                    </div>

                    <!-- Results Screen -->
                    <div id="deescalation-results" class="deescalation-results hidden">
                        <div class="results-content">
                            <div class="results-icon" id="results-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h3 id="results-title">De-escalation Successful!</h3>
                            <div class="results-photo">
                                <img id="results-image" src="/images/de_escalation/1-Happy.jpg" alt="Final State">
                            </div>
                            <p id="results-message"></p>
                            <div class="results-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Final Emotional State</span>
                                    <span class="stat-value" id="final-state">Happy</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Steps Taken</span>
                                    <span class="stat-value" id="steps-taken">4</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Force Avoided</span>
                                    <span class="stat-value" id="force-avoided">100%</span>
                                </div>
                            </div>
                            <div class="results-actions">
                                <button class="btn btn-primary" id="restart-scenario-btn">
                                    <i class="fas fa-redo"></i> Try Again
                                </button>
                                <button class="btn btn-secondary" id="exit-results-btn">
                                    <i class="fas fa-list"></i> Back to Scenarios
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Assessment Section -->
        <section id="assessment" class="section">
            <!-- My Assessments -->
            <div class="section-header">
                <h2>My Assessments</h2>
                <p>Select a course to view and take its assessments</p>
            </div>
            <div id="myAssessmentCoursesContainer" class="assessment-courses-container">
                <div style="text-align: center; padding: 2rem;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--secondary);"></i>
                    <p>Loading your courses...</p>
                </div>
            </div>

            <!-- Course Assessments View (shown when course is selected) -->
            <div id="courseAssessmentsView" class="course-modules-view" style="display: none;">
                <div class="section-header">
                    <button class="btn btn-secondary" onclick="backToAssessmentCourses()">
                        <i class="fas fa-arrow-left"></i> Back to Courses
                    </button>
                    <h2 id="selectedAssessmentCourseName">Course Assessments</h2>
                    <p id="selectedAssessmentCourseDescription"></p>
                </div>
                <div class="assessment-container">
                    <div class="assessment-selector">
                        <h3>Available Assessments</h3>
                        <div class="assessment-list" id="assessmentListContainer">
                            <!-- Assessments will be loaded dynamically when course is selected -->
                        </div>
                    </div>
                </div>

                <!-- Assessment Quiz -->
                <div id="assessmentQuiz" class="assessment-quiz hidden">
                    <div class="quiz-header">
                        <h3 id="quizTitle"></h3>
                        <div class="quiz-meta">
                            <span id="quizProgress">Question 1 of 10</span>
                            <span id="quizTimer">15:00</span>
                        </div>
                    </div>
                    <div class="quiz-body">
                        <div class="question-container" id="questionContainer">
                            <!-- Questions loaded dynamically -->
                        </div>
                    </div>
                    <div class="quiz-footer">
                        <button class="btn btn-secondary" onclick="previousQuestion()" id="prevBtn">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextQuestion()" id="nextBtn">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="btn btn-primary hidden" onclick="submitAssessment()" id="submitBtn">
                            Submit Assessment
                        </button>
                    </div>
                </div>

                <!-- Results -->
                <div id="assessmentResults" class="assessment-results hidden">
                    <div class="results-header">
                        <i class="fas fa-trophy"></i>
                        <h2>Assessment Complete!</h2>
                    </div>
                    <div class="results-score">
                        <div class="score-circle">
                            <svg width="200" height="200">
                                <circle cx="100" cy="100" r="90" fill="none" stroke="#e0e0e0" stroke-width="10"/>
                                <circle id="scoreCircle" cx="100" cy="100" r="90" fill="none" stroke="#4CAF50" 
                                        stroke-width="10" stroke-dasharray="565.48" stroke-dashoffset="565.48"
                                        transform="rotate(-90 100 100)"/>
                            </svg>
                            <div class="score-text">
                                <span id="scorePercentage">0%</span>
                                <span id="scoreLabel">Score</span>
                            </div>
                        </div>
                    </div>
                    <div class="results-details">
                        <div class="result-stat">
                            <i class="fas fa-check-circle"></i>
                            <span id="correctAnswers">0</span>
                            <span>Correct</span>
                        </div>
                        <div class="result-stat">
                            <i class="fas fa-times-circle"></i>
                            <span id="incorrectAnswers">0</span>
                            <span>Incorrect</span>
                        </div>
                        <div class="result-stat">
                            <i class="fas fa-clock"></i>
                            <span id="timeTaken">0:00</span>
                            <span>Time</span>
                        </div>
                    </div>
                    <div class="results-feedback" id="resultsFeedback">
                        <!-- Detailed feedback -->
                    </div>
                    <div class="results-actions">
                        <button class="btn btn-secondary" onclick="reviewAnswers()">Review Answers</button>
                        <button class="btn btn-primary" onclick="closeAssessment()">Continue</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Messages Section -->
        <section id="messages" class="section">
            <div class="messages-container">
                <div class="conversations-list">
                    <div class="conversations-header">
                        <h3>Messages</h3>
                        <p style="margin: 0; color: var(--text-secondary, #6c757d); font-size: 1.4rem;">Communicate with potential employers</p>
                    </div>
                    <div id="conversationsList">
                        <p class="empty-state">No messages yet</p>
                    </div>
                </div>
                <div class="message-view">
                    <div class="message-placeholder">
                        <i class="fas fa-comments"></i>
                        <p>Select a conversation to view messages</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Profile Section -->
        <section id="profile" class="section">
            <!-- Profile Tabs -->
            <div class="profile-tabs">
                <button class="profile-tab active" data-tab="about">
                    <i class="fas fa-user"></i> About
                </button>
                <button class="profile-tab" data-tab="progress">
                    <i class="fas fa-chart-line"></i> Progress
                </button>
                <button class="profile-tab" data-tab="network">
                    <i class="fas fa-users"></i> Network
                </button>
            </div>

            <!-- About Tab -->
            <div class="profile-tab-content active" id="about-tab">
                <div class="profile-about">
                    <!-- Profile Header -->
                    <div class="profile-header-card">
                        <div class="profile-avatar-section">
                            <div class="profile-avatar" id="profileAvatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <button class="btn btn-small btn-secondary" onclick="uploadProfilePicture()">
                                <i class="fas fa-camera"></i> Change Photo
                            </button>
                            <input type="file" id="profilePictureInput" accept="image/*" style="display: none;">
                        </div>
                        <div class="profile-header-info">
                            <h2 id="profileName">Loading...</h2>
                            <p class="profile-email" id="profileEmail">Loading...</p>
                            <p class="profile-joined" id="profileJoined">Member since: Loading...</p>
                        </div>
                    </div>

                    <!-- Editable Profile Form -->
                    <div class="profile-form-card">
                        <div class="card-header">
                            <h3><i class="fas fa-edit"></i> Personal Information</h3>
                            <button class="btn btn-small btn-secondary" id="editProfileBtn" onclick="toggleEditMode()">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </div>
                        
                        <form id="profileForm" class="profile-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>First Name</label>
                                    <input type="text" id="firstName" disabled>
                                </div>
                                <div class="form-group">
                                    <label>Last Name</label>
                                    <input type="text" id="lastName" disabled>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Phone Number</label>
                                    <input type="tel" id="phone" placeholder="(555) 123-4567" disabled>
                                </div>
                                <div class="form-group">
                                    <label>Location</label>
                                    <input type="text" id="location" placeholder="City, State" disabled>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Professional Bio</label>
                                <textarea id="bio" rows="4" placeholder="Tell employers about yourself..." disabled></textarea>
                            </div>

                            <div class="form-group">
                                <label>LinkedIn Profile</label>
                                <input type="url" id="linkedin" placeholder="https://linkedin.com/in/yourprofile" disabled>
                            </div>

                            <div class="form-actions" style="display: none;">
                                <button type="button" class="btn btn-secondary" onclick="cancelEdit()">Cancel</button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Changes
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Skills & Expertise -->
                    <div class="profile-form-card">
                        <div class="card-header">
                            <h3><i class="fas fa-tools"></i> Skills & Expertise</h3>
                            <button class="btn btn-small btn-secondary" onclick="addSkill()">
                                <i class="fas fa-plus"></i> Add Skill
                            </button>
                        </div>
                        <div class="skills-container" id="skillsContainer">
                            <!-- Skills will be loaded here -->
                        </div>
                    </div>

                    <!-- Certifications -->
                    <div class="profile-form-card">
                        <div class="card-header">
                            <h3><i class="fas fa-certificate"></i> Certifications</h3>
                            <button class="btn btn-small btn-secondary" onclick="addCertification()">
                                <i class="fas fa-plus"></i> Add Certification
                            </button>
                        </div>
                        <div class="certifications-container" id="certificationsContainer">
                            <!-- Certifications will be loaded here -->
                        </div>
                    </div>

                    <!-- Work Experience -->
                    <div class="profile-form-card">
                        <div class="card-header">
                            <h3><i class="fas fa-briefcase"></i> Work Experience</h3>
                            <button class="btn btn-small btn-secondary" onclick="addExperience()">
                                <i class="fas fa-plus"></i> Add Experience
                            </button>
                        </div>
                        <div class="experience-container" id="experienceContainer">
                            <!-- Experience will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Tab -->
            <div class="profile-tab-content" id="progress-tab">
                <div class="progress-dashboard">
                    <div class="progress-stats">
                        <div class="stat-card">
                            <i class="fas fa-graduation-cap"></i>
                            <div class="stat-content">
                                <h3 id="completedModules">0</h3>
                                <p>Modules Completed</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-chess-board"></i>
                            <div class="stat-content">
                                <h3 id="completedScenarios">0</h3>
                                <p>Scenarios Completed</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-clipboard-check"></i>
                            <div class="stat-content">
                                <h3 id="completedAssessments">0</h3>
                                <p>Assessments Passed</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-star"></i>
                            <div class="stat-content">
                                <h3 id="averageScore">0%</h3>
                                <p>Average Score</p>
                            </div>
                        </div>
                    </div>

                    <div class="progress-details">
                        <div class="progress-section">
                            <h3>Module Progress</h3>
                            <div class="progress-items" id="moduleProgress">
                                <!-- Dynamic progress bars -->
                            </div>
                        </div>

                        <div class="progress-section">
                            <h3>Assessment History</h3>
                            <div class="assessment-history" id="assessmentHistory">
                                <div class="activity-item">
                                    <i class="fas fa-info-circle"></i>
                                    <p>Complete assessments to see your history here</p>
                                </div>
                            </div>
                        </div>

                        <div class="progress-section">
                            <h3>De-escalation Practice</h3>
                            <div class="deescalation-progress" id="deescalationProgress">
                                <div class="activity-item">
                                    <i class="fas fa-info-circle"></i>
                                    <p>Complete de-escalation scenarios to see your results here</p>
                                </div>
                            </div>
                        </div>

                        <div class="progress-section">
                            <h3>Recent Activity</h3>
                            <div class="activity-list" id="activityList">
                                <div class="activity-item">
                                    <i class="fas fa-info-circle"></i>
                                    <p>Complete training modules and assessments to see your progress here</p>
                                </div>
                            </div>
                        </div>

                        <div class="progress-section">
                            <h3>Achievements</h3>
                            <div class="achievements-grid" id="achievementsGrid">
                                <div class="achievement-badge locked">
                                    <i class="fas fa-medal"></i>
                                    <span>First Module</span>
                                </div>
                                <div class="achievement-badge locked">
                                    <i class="fas fa-trophy"></i>
                                    <span>Perfect Score</span>
                                </div>
                                <div class="achievement-badge locked">
                                    <i class="fas fa-fire"></i>
                                    <span>5 Day Streak</span>
                                </div>
                                <div class="achievement-badge locked">
                                    <i class="fas fa-crown"></i>
                                    <span>All Modules</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Network Tab -->
            <div class="profile-tab-content" id="network-tab">
                <div class="network-section">
                    <div class="network-stats">
                        <div class="network-stat">
                            <h3 id="networkConnections">0</h3>
                            <p>Connections</p>
                        </div>
                        <div class="network-stat">
                            <h3 id="networkViews">0</h3>
                            <p>Profile Views</p>
                        </div>
                        <div class="network-stat">
                            <h3 id="networkEndorsements">0</h3>
                            <p>Endorsements</p>
                        </div>
                    </div>
                    
                    <div class="network-visibility">
                        <h3><i class="fas fa-eye"></i> Profile Visibility</h3>
                        <p>Make your profile visible to potential employers</p>
                        <label class="toggle-switch">
                            <input type="checkbox" id="profileVisibility">
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="visibility-status">Your profile is currently <strong id="visibilityStatus">private</strong></p>
                    </div>

                    <div class="network-recommendations">
                        <h3><i class="fas fa-user-friends"></i> Recommended Connections</h3>
                        <p>Connect with other security professionals</p>
                        <div class="recommendations-list" id="recommendationsList">
                            <p class="text-muted">Coming soon: Connect with employers and fellow students</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script src="js/supabase-config.js"></script>
    <script src="js/auth-check.js"></script>
    <script src="js/student-portal.js?v=2"></script>
    <script src="js/assessment-courses.js"></script>
    <script src="js/supabase-integration.js"></script>
    <script src="js/slideshow.js"></script>
    <script src="js/state-laws.js"></script>
    <script src="js/state-selection.js"></script>
    <script src="js/profile.js"></script>
    <script src="js/deescalation.js"></script>
    <script src="js/pdf-generator.js"></script>
    <script src="js/geo-risk-data-cities.js"></script>
    <script src="js/geo-risk-service.js"></script>
    <script src="js/facility-type-config.js"></script>
    <script src="js/site-assessments.js"></script>
    <script src="js/site-assessments-form.js"></script>
    <script src="js/site-assessments-report.js"></script>
    <script src="js/messages.js"></script>
    
    <!-- ElevenLabs AI Agent -->
    <elevenlabs-convai agent-id="agent_3501k7vzkxnzec2vbt1pjw2nxt47"></elevenlabs-convai>
    <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>

</body>
</html>
